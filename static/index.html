<!doctype html>
<html><head><meta charset="utf-8"><title>Die League</title>
<link rel="stylesheet" href="/css/styles.css"></head>
<body>
<div id="nav"></div>
<main>
  <h1>Die League</h1>
  <p class="muted">Register or login, then use the nav.</p>
  <section class="card">
    <h3>API/DB Status</h3>
    <button id="ping">Check</button>
    <pre id="pingOut"></pre>
  </section>

  <section class="card">
    <h3>Register</h3>
    <input id="r_name" placeholder="Full name">
    <input id="r_email" placeholder="email">
    <input id="r_pw" type="password" placeholder="password">
    <button id="r_btn">Register</button>
    <pre id="r_out"></pre>
  </section>

  <section class="card">
    <h3>Login</h3>
    <input id="l_email" placeholder="email">
    <input id="l_pw" type="password" placeholder="password">
    <button id="l_btn">Login</button>
    <pre id="l_out"></pre>
  </section>
</main>
<script>fetch('/static/_nav.html').then(r=>r.text()).then(h=>{document.getElementById('nav').innerHTML=h});</script>
<script src="/js/api.js"></script>
<script>
ping.onclick = async ()=>{ const r=await fetch('/api/status'); pingOut.textContent=await r.text(); };
r_btn.onclick = async ()=>{
  try{ r_out.textContent = JSON.stringify(await API.post('/api/auth/register',{name:r_name.value,email:r_email.value,password:r_pw.value}),null,2); }
  catch(e){ r_out.textContent = e.message; }
};
l_btn.onclick = async ()=>{
  try{ l_out.textContent = JSON.stringify(await API.post('/api/auth/login',{email:l_email.value,password:l_pw.value}),null,2);
       location.href='leagues.html'; }
  catch(e){ l_out.textContent = e.message; }
};
</script>
</body></html>
